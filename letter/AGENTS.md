# letter/ — Codex Guide

## Directory purpose
- Canonical signed ASI Letter releases with matching OpenPGP signatures and OpenTimestamps proofs, plus the aggregated manifest used by tooling and the site.

## Key workflows/commands
- Validate signatures: `bash scripts/verify-clearsign.sh` (also used in CI).
- Generate/refresh manifest and metadata: `python3 scripts/release.py` (or individual steps `gen_releases_manifest.py`, `update_version_metadata.py`, `sync_docs_with_latest.py`).
- Stamp/upgrade proofs: GitHub workflows `ots-stamp-letter-asc.yml` and `ots-verify-upgrade.yml` manage `.asc.ots` files.

## File map
| filename | what it does | important invariants / gotchas | how it’s used |
| --- | --- | --- | --- |
| `ASI-Letter-v*.md` | Plaintext Markdown releases of the letter (versioned by date). | Filenames must match `vYYYY.MM.DD`; content should correspond to the signed `.asc` files. Avoid manual edits to historical releases. | Source for docs sync and verification; referenced in manifest. |
| `ASI-Letter-v*.md.asc` | OpenPGP clear-signed versions of each release. | Must verify against `keys/FINGERPRINT`; keep aligned with corresponding `.md`. | Used for signature verification locally and in CI; stamped for OTS proofs. |
| `ASI-Letter-v*.md.asc.ots` | OpenTimestamps proofs matching each signed release. | Must correspond to the exact `.asc`; generated/upgraded by OTS workflows. | Provides Bitcoin timestamp attestation for each signature. |
| `RELEASES.json` | Manifest describing all releases, signer fingerprint, file metadata, and timestamps. | Schema `asi-letter/releases#2`; regenerated by `scripts/gen_releases_manifest.py`. Keep ordering/formatting stable; do not hand-edit. | Consumed by site metadata updater, automation scripts, and CI workflows. |

## Codex operating guidance
- Edit policy: Do not hand-edit release artifacts or manifest; use signing tools and release scripts for any updates. Preserve versioned files as immutable history.
- Validation: Run `python3 scripts/release.py --check` and `bash scripts/verify-clearsign.sh` after changes; ensure `.asc.ots` proofs are present for each `.asc` when shipping releases.
- Common failure modes: mismatched version names, missing `.asc` or `.ots` alongside Markdown, manual edits that break signature verification, forgetting to refresh manifest after adding/removing releases.

