# letter/ — Codex Guide

## Directory purpose
- Canonical signed ASI Letter releases with matching OpenPGP signatures and OpenTimestamps proofs, plus the aggregated manifest that automation and the site consume.

## Key workflows/commands
- Validate signatures: `bash scripts/verify-clearsign.sh` (CI uses same entrypoint).
- Regenerate manifest/metadata/docs: `python3 scripts/release.py` (runs sync, manifest generation, metadata updates) or individual scripts in `scripts/`.
- Stamp/upgrade proofs: workflows `ots-stamp-letter-asc.yml` / `ots-upgrade.yml` / `ots-verify-upgrade.yml` manage `.asc.ots` files.

## File map (every tracked item)
| filename | what it does | important invariants / gotchas | how it’s used |
| --- | --- | --- | --- |
| `AGENTS.md` | Directory-specific operating guide (this file). | Keep in sync with release inventory; defer to root conventions. | Contributor reference. |
| `RELEASES.json` | Manifest describing releases, fingerprints, file metadata, and hashes. | Schema `asi-letter/releases#2`; regenerated by `scripts/gen_releases_manifest.py` and `scripts/release.py`. Avoid manual edits to preserve reproducibility. | Consumed by metadata updater, docs sync, CI workflows, and OTS helpers. |
| `ASI-Letter-v2025.09.14.md` | Markdown for 2025.09.14 release. | Filename follows `vYYYY.MM.DD`; content should match its signature. | Source for verification and manifest generation. |
| `ASI-Letter-v2025.09.14.md.asc` | Clear-signed 2025.09.14 release. | Must verify against `keys/FINGERPRINT`; keep aligned with Markdown. | Verified by scripts/CI and stamped for proof. |
| `ASI-Letter-v2025.09.14.md.asc.ots` | OTS proof for 2025.09.14 signature. | Must correspond exactly to `.asc`; updated by OTS workflows. | Provides Bitcoin timestamp attestation. |
| `ASI-Letter-v2025.09.17.md` | Markdown for 2025.09.17 release. | Same naming/date pattern as other releases. | Source for verification and docs sync when latest. |
| `ASI-Letter-v2025.09.17.md.asc` | Clear-signed 2025.09.17 release. | Verify against trusted fingerprint; keep paired with Markdown. | Used for signature checks and proofs. |
| `ASI-Letter-v2025.09.17.md.asc.ots` | OTS proof for 2025.09.17 signature. | Keep synchronized with `.asc`; generated/upgraded by workflows. | Timestamp evidence. |
| `ASI-Letter-v2025.11.20.md` | Markdown for 2025.11.20 release. | Maintain naming pattern and alignment with signature. | Verification source and manifest input. |
| `ASI-Letter-v2025.11.20.md.asc` | Clear-signed 2025.11.20 release. | Verify against `keys/FINGERPRINT`. | Used by verification scripts/CI and OTS stamping. |
| `ASI-Letter-v2025.11.20.md.asc.ots` | OTS proof for 2025.11.20 signature. | Must stay paired with `.asc`; updated via OTS workflows. | Bitcoin timestamp evidence. |
| `ASI-Letter-v2025.12.14.md` | Markdown for 2025.12.14 release. | Keep immutable; aligns with signature. | Manifest input and docs sync candidate. |
| `ASI-Letter-v2025.12.14.md.asc` | Clear-signed 2025.12.14 release. | Verify against trusted fingerprint. | Signature verification + proof stamping. |
| `ASI-Letter-v2025.12.14.md.asc.ots` | OTS proof for 2025.12.14 signature. | Match `.asc`; regenerated by OTS upgrade workflows. | Timestamp verification. |
| `ASI-Letter-v2025.12.18.md` | Markdown for 2025.12.18 release (latest). | Follow version naming; keep aligned with signature. | Source for docs/manifest/latest metadata. |
| `ASI-Letter-v2025.12.18.md.asc` | Clear-signed 2025.12.18 release. | Must validate against `keys/FINGERPRINT`; keep paired with Markdown. | Primary signature for current docs/metadata. |
| `ASI-Letter-v2025.12.18.md.asc.ots` | OTS proof for 2025.12.18 signature. | Corresponds exactly to `.asc`; updated by OTS workflows. | Latest Bitcoin timestamp proof. |

## Codex operating guidance
- Edit policy: Treat release Markdown/signatures/proofs as immutable history; regenerate `RELEASES.json` via scripts instead of manual edits.
- Validation: Run `python3 scripts/release.py --check` plus `bash scripts/verify-clearsign.sh` after any planned release adjustments; ensure each `.asc` has a matching `.asc.ots` before publishing.
- Common failure modes: mismatched filenames vs manifest, missing `.asc`/`.ots` pairs, manual edits breaking signature verification, or forgetting to regenerate manifest/metadata after changes.
